use File::Find;
use File::Spec;
use Cwd 'abs_path';

# Paths
my $chapters_src = abs_path('chapters');  # source chapters directory
my $build = abs_path('build');  # output directory
my $chapters_build = "$build/chapters";  # build chapters directory

# Ensure build directory exists
mkdir $build unless -d $build;

# Recursively create subfolders in build/
if (-d $chapters_src) {
    find(sub {  # iterate over subdirectories of chapters_src (including itself)
        return unless -d;  # only directories
        my $rel = File::Spec->abs2rel($File::Find::name, $chapters_src);
        mkdir "$chapters_build/$rel" unless -d "$chapters_build/$rel";
    }, $chapters_src);
}
